import smartpy as sp
class DeregisterVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_deregister_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        vk_h = sp.bls12_381_g2("0x014fefcdeea3463335e199ba03332f027ff8b1fce3fa114697fc3ca1d3debfb428d73d3e7660c16f4aff076e5e4a870e1638ec08727d5ef007e746401ce3552321aefe6d1b1db09169d3210b55673c29c7f0a1a1cbb6474ec8ad50814578171e0e6d2af4b2292d3ad90d226299cf35dbff7c4dcc639d6afa1bd39da6d4f0b6a3319aa741f0c7debbbe054c779e9570b1075c2c9e86b5b64d6a99fa4451b394e55729ee1673311c6b166ead71ad1be29595b83d9f811370e3df23943fc3914d71")
        vk_g_alpha = sp.bls12_381_g1("0x10abd18a5a60faa60895d6f094e78974d37af7c44ffd2ff72097c195568d5f8048203388dfa03c01318162b10993824905a2624ddc4d62cd2fd6e6901c3b779cdca7b3c30bb4e9d2f847ce4f8b4c011bd5d4f252876b1e9987f29b3db866e990")
        vk_h_beta = sp.bls12_381_g2("0x0129bf38141b62210a234d2da54ef14c1c24e68f0f6f0361c2e6325caafec497c1079ae0a239b7db6ec363a0ec48d2c714e8b9a28bdc3fe65a7dc026d27aa24938c2d4ab013aeed51823e0c92196f9e8b10f182232c55a70cf90aae198d0d3dd0b47c719b60cc51b0218287603669990ed7a18db87f6b229a0de56d0759fd7344e1204ac5789098a170bc9ca97a3855601c00b6bb871f573fd404d82f7a669c94c10b088015d717c922c6aedb93ff3915bec33eb8a4ce976f77843473041cab7")
        vk_g_gamma = sp.bls12_381_g1("0x0e8129db03537991c7b6c78892db1553ce03a529559c74a211478dd38d9adb53747b40ed19b72575563510a4cd77379f0d6d2652afb3a580bb137b7aaab89b6c4afe9179d8fc8202ed2e16dcf42ba9a6a746c0c80113feebfd511d3b6e87127c")
        vk_h_gamma = sp.bls12_381_g2("0x014fefcdeea3463335e199ba03332f027ff8b1fce3fa114697fc3ca1d3debfb428d73d3e7660c16f4aff076e5e4a870e1638ec08727d5ef007e746401ce3552321aefe6d1b1db09169d3210b55673c29c7f0a1a1cbb6474ec8ad50814578171e0e6d2af4b2292d3ad90d226299cf35dbff7c4dcc639d6afa1bd39da6d4f0b6a3319aa741f0c7debbbe054c779e9570b1075c2c9e86b5b64d6a99fa4451b394e55729ee1673311c6b166ead71ad1be29595b83d9f811370e3df23943fc3914d71")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x067ee371cc1af2a3630cbcfd470a01164910e1680ff1c424c6255fe730f6a149bd298186cc7dc23f56aca75d09876a7117f6becd79e9e7f4b1166d13258584370eb45646545de00e6171893531d56077d7ddcf24ad03a3514d055e9df4fd313a"),
			1: sp.bls12_381_g1("0x04b85cc942b3a346aa57e7eece84765ccff9224f7876f26bda707445a529124f0a0807d63432bcc7f4421c76c4dcd18111873198b07fcd2154ea5ced2d075c7b00a66247028ab0e1cf7bd43558edaa3cf98f0878930dda12d409af45ae351022"),
			2: sp.bls12_381_g1("0x10bd5951344069acc6679e2b02c1ac9d45662d662fdcf80a101ddbbe82be2e6b84c51a1b7d3d1d7bb780bc890e0286fb17691276aaaec3fdede8d8ad09db7f0ee6dbb688a1864c19c1319fa3e31cd3ad77e2a995debed024d1bb37bb9eaeeca5"),
			3: sp.bls12_381_g1("0x0afaeb414f0ed15806e0424f05333425f649e68774473c59ced5dc3b882e929749d099b8d35b98c9a914b2bdf2ace5250eb8484b0d89c2b3ac33eabcd1708c47229d9f1db8bfe5a80fb1f7890013f94c5665209de154e4f1b99ad58a4d515b52"),
			4: sp.bls12_381_g1("0x1415b47fe4e80785255df62538241284394bce01732ec30118403c8e37c1c06769fc73656d1b14fefca1905d64823a8415272bdf420b91a83275123f0e8a838d0160728b2708b49456eac79fc4b98d1ffc14dedfd39b479f932cacbec683550d"),
			5: sp.bls12_381_g1("0x05b971cc298bf5b0623bdc4f782a822ef329f6e1f34f51e1bf88c802ddf9bb581a676579cce200457d600d285b0b10a707406150ef6d48cfb816ad3f3f557ee1db47b264fb91577267a7361da8d288e8c2ea5516122d9dee8af322776490d33a"),
			6: sp.bls12_381_g1("0x19e7d9df0cc12fd32bb29132a4f4c6b56d946c1e54b345cab3e167358b4d9b0f58cedfa09b926ed5a2f4ded808c4afe20aceb1f320d01c084723ecbd2211a126fc2ea88b22cc0c3a2dbe729b881e409480b4d9527acebdb064f4a3caec4696ba"),
			7: sp.bls12_381_g1("0x15b0a5014b7b95f21b52b9dc9e6281a8ff5d58fb98b224b080cdeb963f4f426b9e72564c12d1407447f62a9e5df3b20602b06d258d46eb9396fefce291ad83c529cb0274046c3f0effa53c3d602f3c4ffbc0f4ad20f41f52abb7eecc05ffb73c"),
			8: sp.bls12_381_g1("0x055d6ae4d6fdf1d2c0c37dff01e88f622a56e7a5b1014f3fe9bd757ac3a3d767792abac297a3cb873fd4a674a5660a5d0a2acd30809330a9ea419c614f0d92972f06d7c61abb77c3bfbdfa3af8158488bbff7d567ec6960803b8c79cb1493b8d"),
			9: sp.bls12_381_g1("0x07bf54508515345f28f90b1da0e6c7959971ae5ed1bca651ed486d2e42bf716a90ba25ce1759665d03dd160373e112650bd3fef244beb3204c6c5083bb7cc9c84d4867d21031de2e132c37df066d4b51c3d7e318ac0d17ca096f2ba34db6de21"),
			10: sp.bls12_381_g1("0x09baae694d1788d2e444b574aaadb3aa13050ee70b883d3af5712fce67356dec2268539dd4cb695fd8e79f714bc45a5d045e19b642388daa7b738d8b072e8533783ebe26440fb69e06b94b26560dd0d0e29a7a11479a667fe6a307aed8e6aa02"),
			11: sp.bls12_381_g1("0x17576272f3a690dbde47ab01a67b1c0d30422f746ecc9d96219dfd5b35077b9cc31e25447bc42e49f7ea502dce8df7c20e3272e81b81c1c5ae6c9a3318595c9d5556ec4ab1334621cdaa873d45e1b583734652c73a18dddb9c8b545add27c073"),
			12: sp.bls12_381_g1("0x11651b17bf942d872c7f1188d28e584e0e85a440e9a1a4e02427d795bc25eda9167aafe6093369cd526517b7681f935915caeadb27c6e6dab788b23b4f404600be712538f3edb1d5cce1641e543d0511f3549771074e0734b157148591844f36"),
			13: sp.bls12_381_g1("0x0ef27020a21afa5adb4fcccbb2af9b070403bda4c0b319efa56f6dff4c906633d58c8cff3caec9ad50591f2bd3c19a10047ef8de3f152d77326ddf3cae7dbfd307371e4727bb6300b0c2162017d96f88b3ebc1f2e4563d25f6de8786249faf3a"),
			14: sp.bls12_381_g1("0x12186f14ac3a54a08435a1b40c466af83c1ad277d33fa84494ff63f025c86a6264a4c59334313d4943eb868cf287ce7418edfaafbc88420a343c8001870b23b3b1829b95f93fee00a9c2eda376f55de2099bb205823de6e08c496522542a5431"),
			15: sp.bls12_381_g1("0x0abdc3861c70190b0c905fe0555b4bbd181c06a52919a8583e2622308afcec9c07d6f8c66696b40be220d9950a437eae16f65f526dff4ecc28ed1af03408d19c0a525fdce6f30c50e44daf6cafce757490001520659077a29a150e4785b6fdaf"),
			16: sp.bls12_381_g1("0x128e712cd4093db24ef8cbb1b0a540dee4fb51f4137b12f5a41976f98b2d243db0f0922b1b43e16481f9d3f73e13dec9001d1a25f8eda51bc8b2162bc2899f385f39f55413db65dc952a4c1442d6d97c45d41f9b452173508815f8394f1ac51f"),
			17: sp.bls12_381_g1("0x12362b1b6f9b7823f491c219008c3d0acbcfbe079e02e01723dfa50fda74b60b707d673e9c60d8254f2a44cda2385fc418136915623e0f3a41b216f60738f441139316bf8592de1541cfc0a56f5ccb6c9986647527d2898c66167585ca4d1031"),
			18: sp.bls12_381_g1("0x0f1c337cff78060e7cc1329bdead5d482d0c99073d2076bb5dd9b6ef44be6cb8a46b4e175985f48192169e52d443ca0a15e73bc1470ba47c7beb25d25c7df9f7b89c5517f5acc32a0d89808e1667ba33a4c33de59c9800e319ca43014d5dc6d6"),
			19: sp.bls12_381_g1("0x0ce47a64c38991f791fc14612464e1fc8369b827ba2059666a72b882109a391deb6003bc691682beca81ebdb0e9ea360090bd51407725a5cc64ce92a7f701416459adf587e0e77be80d76efc776d876b5788d9c618e413f1fa76c09b157732ea"),
			20: sp.bls12_381_g1("0x1892d7002a4b141d42ee23ee6cdced22dc73e9cb68986f6be831b8bbfbcf371bf35dd141a688d74aa4a93a991abb7db4159c1df87c6cf0c8d8a7130cbc0b30037c232fc29cf241923497c0d2d08d3b9055ae8e6d076c0d1efa914b161efbee55"),
			21: sp.bls12_381_g1("0x1186a4bbd03eac36901c039aad610ddb3eca5ebd54e05c6083628109fa3fc1f0cc9d7c12e058084edc9df6793f645655016a8d069554b886c6056c5d1dc84ac5eb0a3dc5db83e1692dcfa8e5a24af190070b547522f649720498d74ab512acf3"),
			22: sp.bls12_381_g1("0x0fa60c81222e0049a391b5d959dbc7ae761b9454d396fa9ae11bf1e72c581227d929f80dfe92bd90b2da908286d8bfbf0f622d7432f5cd76461d2122ff4f5f53c2b1213c7aa2af64fd6c33d3c3a08f32288a58a031856064f6276bd74e9bf705"),
			23: sp.bls12_381_g1("0x024da93f7257dc79ad0527b6ac05983a2ad80952817ca501512cbe42960f668182bc12c497810a1cbe9b2d8c52ea55600aa2268eb221e052724baa4c71de6a9a132af8abf64bc3eca1f7ac26436c157ad12767ae305c8c1654656fbece649511"),
			24: sp.bls12_381_g1("0x16594df25b8c21fa2b06d009281fe55581542bc49436bc8e441f06f9a600934a3d7e09a3988ba3252ea4503c9a3678ca10ec8d29c598b053dce67acda74b9dc830b6b47912aa3d5e4c2eb5d779d4f33253d729bc925444c7a994a9940075d9a4"),
			25: sp.bls12_381_g1("0x0320063275cbe938e7f1722e4ee9f66f3fce27b199718eaac60bd199dbd902129e4637388ada7ea0da3b04e4a11ebfd30d80a1ee10a3a34d9a51e78ed8370432961399c9c1af455776d209b363361560806d36ab0203918203e25c77ec53e44b"),
			26: sp.bls12_381_g1("0x1710b96abea6de6d5a52e5ffa88216123a869ba5a5f136288d16bd5c488e3991394fe72c201f26d8a317b1f12c5d6ed60344c2aa8280beaeb1300d45b97f44218e9550f747f0077202a08e4e16299f814455501f64155a2ddf38efc80e1e548a"),
			27: sp.bls12_381_g1("0x0c0b01dcd13e661bbab9b089519d4a8f424975b1c1c26c4e8b6723ff38a51f2ca91f63aded81ae36a99c339a8040ab630c208e0941854998666fff1ff400b5b9fda3ce80322cab7574eea24d0bb4aeefd0a2e37b2b8fa72a4f8875c55731a8b5"),
			28: sp.bls12_381_g1("0x023d2e92eb8b08fb38fcb3016fa9c2ac2905a434065454408b2cff6bd1becd7097544bc0b24ee408468e25e0731130cf011acc20953a2ccfabfc5a2294034d4ded553c43e117aec75fbc652caba175f31c6f18c1527b341f5d5c74c86ac6a127"),
			29: sp.bls12_381_g1("0x19cba2d00abc4b3eb4d84e84c1e68d3bc00b0efcf0c0d3f978bc2b7d4df718814f4f13a5e6a93b0ae8f81f088d5b95040abec807ed83be4c50fee887b7a868cfcf82e2ae5501ee3d29ea0ba321ea67bc3bae19dd82ac4af94f11dd8074d50aa4"),
			30: sp.bls12_381_g1("0x0164f4e77ba542a63d93a10d3a5f96239c2a0af266e1b1d9f3daebe04121dcdd365116d06c87b3d7684b129249e8bd4911b478848f18c643684cdfed23fd9c7d070abdf9e9afcb9a326b2bb1b41d2d76b063db5bd330a91b249b47bebf30e622"),
			31: sp.bls12_381_g1("0x18fcf4a0005ee48cb1fbfc852d55bcf157be5d44fc5865c40dda1b0adc47e0fd342cf3c0aff3d07fa2189cba303002a50b42bac300cbff0f3164bc476d62fc8d65b2f076a5e578f9a33579240bc2825efe00cae2c02c9c65b3f073027aa93e42"),
			32: sp.bls12_381_g1("0x05e5ae311fee45602d78d152d981abcd0d07e34532b572539cdd9c6fecfe254eda143b7aa46209ab1012c7968f06c4681664b8abb1b430bb7c8a6425410c7777be4fcafdce66ca11e88702b5bea5d3249294acd876327ac0e1dae8ff6c439b80"),
			33: sp.bls12_381_g1("0x198500221090e530781e1968dd4e243620a76bc2d694df956115b59209fdad3ae0f4015f54e64fedfd225651ab5329500bfee4de48452761c10779e83d0ab58542df5305a66313387f96a69bcd014ce33bc689c7d6033a70764a09a7fabc45be")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("DeregisterVerifier", DeregisterVerifier())
