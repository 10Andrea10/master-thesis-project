import smartpy as sp
class DeregisterVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_deregister_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        vk_h = sp.bls12_381_g2("0x0701ee658b764410bc4a87e818d28bffe848c254424a2dcfd55532b90fc571c5ed5d88b771ee74ded110654d7130261d17dd78e71faf94edba579274c1285c2032120e9e4274a1b7d8f3c77ef2aff44ceeddd18b2c8b219cebf772a1fedb788f16416f5243f4fcd2d7682e254a2a2cdd0e1d6847e3dd9dedcb91ea1b903b59d074770ff7e3b969e52b2cf0ddb69af1e70c0350006a96edbfd536ff7a8657941383ed21fbb2f16255120bddd7d1b3fb58e877971a03bb30f7a224a510b6560614")
        vk_g_alpha = sp.bls12_381_g1("0x07e64064aaa5e334075e633e8f79b0970f826f26b357a16ea6f56279b13114619defe1eb3e371589bac611a76db7c64b0dc14b7e1e03e28ba2187a9381f888c5709ba6ecd461af71eb27d9c28aa3a019a1268d0fb1fd227edce1178317e76c8f")
        vk_h_beta = sp.bls12_381_g2("0x0b0433e0918e3836ca8a2c9838af1619255e87b1bb22a2df87fbfbc37f227ff4b45d58708dbe04b34456c85c8b1ced6300ee782dee8a9e173ee4ea30ee2008e3e4cc51537e1774fb9e2a5f822ecd016a7e256af304b1b29d32d57493061fe66f129fdb6a4b145e9de5451d7409217f8a1de064f9d7bc78025dde7033620dbe34a19470b3bdfb7a48794bd2dbf50d68ca0c58de9191671635254b8ac9cafe177f52423df5ffb348449eaa9fda34d6389c2d457a83378eaa624d4d91ea17a496c8")
        vk_g_gamma = sp.bls12_381_g1("0x1967058c050baffa7bc5fc8f6e028c3d44ab0de21fcf2b77124977fa42b426df0351ec89ad971cd13250a95dba946f5115613052ec4e72e0eb575b7702c20e4acebf2ca9a734c7f8965185802d1440a027a32628296a79279f935942a86efd8a")
        vk_h_gamma = sp.bls12_381_g2("0x0701ee658b764410bc4a87e818d28bffe848c254424a2dcfd55532b90fc571c5ed5d88b771ee74ded110654d7130261d17dd78e71faf94edba579274c1285c2032120e9e4274a1b7d8f3c77ef2aff44ceeddd18b2c8b219cebf772a1fedb788f16416f5243f4fcd2d7682e254a2a2cdd0e1d6847e3dd9dedcb91ea1b903b59d074770ff7e3b969e52b2cf0ddb69af1e70c0350006a96edbfd536ff7a8657941383ed21fbb2f16255120bddd7d1b3fb58e877971a03bb30f7a224a510b6560614")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x155dbe3ebf54e8f619a3193d89f19d77162dcb937c2c1e22a2a8d21240a99c82569411fce2da68d1bfef49c11fe8f1f90f5d5d2d801c693cb2d7767a84e9f40a40f804f86490921393b696e92998e342400388ea6f7ff82ccf3c98a687f3f6a5"),
			1: sp.bls12_381_g1("0x14b9c1b6ea6accab770ad26b6c8a7a74f70211a28d3aa43c374928637d69ae46c1ba20d909c3c72fdd57d043403292c21362df858b3a933a6b8c38971fbce6855274aa3298fd44ecde548acf4672b1d847e8227ec5758610694e2070da5914ae"),
			2: sp.bls12_381_g1("0x02267453a49479d2b33ec0873309001b259c8d6425a0ca63d5584c5e2bdfc25a4e914ff8b7125d400026bb90b3b018bc1254021cec371d134a022f3005f2b0a726b48cb2b0eeee3062f5365559d108f075c0a7683f033c581bf1d834cd8d0250"),
			3: sp.bls12_381_g1("0x0a1e787bc9f33588badbd25e3560238e57a8f779d2bb713bd11ee290b2ede8e9919367ce9e68b3ca2ff383dfbe9d527e079188393ed9aecb72577579648818bd743c1462bb0c8c88b92ace38a80b6f50a2e59817257864892a761c8ffb489b2b"),
			4: sp.bls12_381_g1("0x0919f5f91b8fd58dbe12cf170e7132ac6dd3da5062bc914f38c11637fd8afe2beb8f5712a1e81d34e25e65732309115e03adc3efbeea29686984f8c3a0d2b3789d841f256afc71300bacf1acd50d6e0904e858f10ebbdebe7b1ea910747204f7"),
			5: sp.bls12_381_g1("0x02539d236ecc34e17c8d12f0b86d3f2a03418d09862fe700e23fa7f7dc6bb699721ddca3359e2f894014f6d5185d756014afd2af5dfc5951e6fb487ae12875ba52a22b768b4aa825271d177c295b5fb97a3c8641505d8d55ca6765f9b8e8c2f9"),
			6: sp.bls12_381_g1("0x12e00f770c239fbb2732a1a3561bf3f9d3d264cdd7c750619b87e80b1193bc988dd12375f4d106799f75ccf7ed8b2a160fe18adf3d4bac065ea72bcef8fabe20c910a5becdbe0764852b7a323ebddd69de9ed752b2df2fe619c08a9422dd5eaf"),
			7: sp.bls12_381_g1("0x0853724d6470e3be671af3e91f04d0d301f7f5c84c5f369e8bbbd796d52f22560c02af96f8d3c9c273410ad3c7bc33d81846493f1190aca91b2d76e12448e8fb31f40a6cd06b529d9372044681ab6ced90c8889db5452bcdbca0f62ff4029d4d"),
			8: sp.bls12_381_g1("0x15548bf7b9b33790569d5f3135e74bf2a129d570832b31e2576bf0fb0a992126a4fa77157b8b66d282394518d0df100119aa10b19e89afa7c1f07d2674f4cf1069c618e19677b4f2dacec665912e329e33095585a75500fda9f34d22e59bcff9"),
			9: sp.bls12_381_g1("0x0626d69da829e072329115ccc725de60d9500f0234d2bdad5c14bba76be67a3bdc88657e5d3ab5cb457dfb54b6ad88e702f934fe41facc3c414555407dcdbba257e34c0a9d39c542e2fdee8f33e0286941b5b018760ada37956446fc5383c598"),
			10: sp.bls12_381_g1("0x1087afac100125c0d6f3c519f7d590bfc3c9c1c722b1b18f8af8c5aa100bb3204df985b35699c8931984ce3b3a346f9c092dff63bc62d1d8bcb819069628a8d5d9ca2bcec1128064e0d1e2bf91d6e2e4c51e3e7a41c4a718f00b4291798a1e7d"),
			11: sp.bls12_381_g1("0x13996e8e6880b63f30f07cbb8bac06c66016e5e7e74b4149e1b9b0e28942b45f3167293a43df7df27c57a36058aa864102ca1aba5dd1aefe57f881f1d611f69a6a4c8d6057f37ec7df7be3978a353e5734b883e773c9064d986ab5e6fb4481a0"),
			12: sp.bls12_381_g1("0x19a9c5fff470ca726dfc23fc588e818985e4002834550ac18c5d5aa1e369c48bc6ecfdda38f3f03f5007c798e1b716b40742195de4f71f3a369ee1e260601d7dff81c9ac3e604c778e960aab1d3b257f4219b8e8309376703fd853b2b1d2c1a5"),
			13: sp.bls12_381_g1("0x14c2fd3e73d927feeb7cdd666aa18a09af3af23b099a2c124474e40453ba3f1b5425b2a062fd35c6a6212cde96236817016a64ba374d63f4df933f824a1e68d24ea7669e5844f3455c6fce9b961a2f586e0397d6933dad74f0b92bfa1716c9c0"),
			14: sp.bls12_381_g1("0x131b60e2b5f210cc4a90659159e21c5177dd67946c5ca15c1edaba694ad46e0c634bf3c473a6024c2d99be56a930c8840e2e5b423383d7dcf1acfa077985d789ead36b8ba6cf4a9090f207e186a5aebde886c36e97fe0a4158a2f043d991eff2"),
			15: sp.bls12_381_g1("0x08f0d8c2124654771cbe967ef967410b988983520da84546efb2ac094224768525754451b61fe9f6e5c83263e534a35116a58dddff9b72c6c99038262be76eec6f016357c72517ec23ae3f1bab3fd4923a2ba006518600ba83b98de958fe9fba"),
			16: sp.bls12_381_g1("0x16598fd2129666ed63bf23673e474412098e6038875aba2aebed05857ff2b132a4eb3585143893ccd5d856c1afc77f000844b73f2713981465ea5618b01be862f6de8c00c96cdc3909ab3aefcc383ad11f3b474c32caa3b3231e92086a95139a"),
			17: sp.bls12_381_g1("0x13d84e78697db36f8679a9e5c6e49b27643d2f31a2bffd22d5d8f5938f5e3560a65c858dfdc8b9db7a7506c33f4f51930f26fbb7faf9abaf62da6fee22b89946c6555f44d3c9fc77d17c6777d51c0e65da3db50c3bf7cd81af8c2e41a4d8a5b0"),
			18: sp.bls12_381_g1("0x17b0fd11f715f7c1ff181d7522a51a9a120580f96cd8a8fee63c9cdc845ed1fa898598c7a999d148e87d3500c82e544107f04bd1878c572daa406399fe7cf1d1c3064ea5b7ca62d32afb82b63aa46999d6cab0adbaeffda0fc4196eb688258eb"),
			19: sp.bls12_381_g1("0x0988fe31112b4261e197eb914f919fd18df3f9812e6eb00c5c666e4dbf6eedb3d060ed7a20b582febaec3949b17eaa191924f41a9d7897870a6e7091999d9ba6573fb03ba416f2edbc962c774593f9b1b22e97d1603df0cee97aab86c3ebde12"),
			20: sp.bls12_381_g1("0x031b57548c9b546df7048ad92f177257c61e44db049244355cfc6aaef6deae68907c144c1d601b1ad6991f0b70bfed79042a0867d315c5db42e5d37172b29308d1a9dfb40754f83a5ab02ceec4e61be7177d6e12bc83965ac823594a15d97b8e"),
			21: sp.bls12_381_g1("0x096a277dc661fa2526d1fd865556eb098d259e0f204eec1f564c7238e9bdf721ceca5e01ce376fbfecf684c9f74efef919fc05d464cf82840c8b41393e303e45eb39811485f3327b7b7a1a0a34af6fe074b668866d41c68d33397b46c13d853b"),
			22: sp.bls12_381_g1("0x0ad213b32972aca33103546361dbd1e7034c61ac416451333aa848e4452947449be2eda7444e0fe9880150b7e46527610c3734d82e518a444a049628cad63750e0cb93a8a3078ef7cc8f8282c997dff0aa800ff5c111775d99a900f8877abe15"),
			23: sp.bls12_381_g1("0x00faa4c07242e0387362ea8fb1fd9bf22588024d916157cf724dd2311daccced9f0c61a70bc4fb1f40177c67c09e4ea012129a80c21bb7a3dbefe9ad91745547da631d21edc06cd8a68cd6556be75e9851d89da68774174d0989f183f5905c09"),
			24: sp.bls12_381_g1("0x01476c98e2cee453b11994ebba707b0d6e62c21dba9227a3e850ad4de7f52d2b93f508ca90f505d471654c8712dc380719dd445c4a0ec58bf46d3aa2041db814423121d146c47c06c07c278b978c39ac2353e1c3b4e48ee0275d6e7610dee025"),
			25: sp.bls12_381_g1("0x179557ea6748777f58cd5a486b7b46d3de49fa09d83c796bc663f1dfb1cc06949bf27578a42ea581b946c63acc19fc65155c4a670960f39500365c121fda548e2853878a99c443694307157101edfde2d860f14e33e73a6c3376b41e97a2b7b0"),
			26: sp.bls12_381_g1("0x035eb80ab731b63185362e8b944d22162b08a64fbc4840c70b6fe4f891fb831757302a96e9c72adfc446fb2a0d48177312a9a029844b84d26aabb2312e9a8ec0c2e7d1683604346a9d571be6819c2bf9b4002088674f1bfb56cad4ce1b6cd105"),
			27: sp.bls12_381_g1("0x0cc1bc3bac52c6e857112a292588b56061a75d62320fde03af84af159c35cf2fa950b911b4ba8ffe3aa8b2a399e6b54a12a5dcd9ab413781f335e965e5793ca59ace56cbfa9418522815c233dae845048aaa6d83fb983f4923879499fd0eb5d1"),
			28: sp.bls12_381_g1("0x090e2d27ec8250a497a732006772557b17173210a618626d159cd165da27ff0de65a7293d640f05c081fe6a1475299a00da88b472dfd038808209b3aa09317bba3093eed0abe5bdf0c3fdc6f31463c4ca50ee7d78c948fb4ac67beaf4304640f"),
			29: sp.bls12_381_g1("0x17563e4d522da2dd2c8a31cfc634f5d1326a31533a00a31b2d250545c287bc930cc181277555a62b1e953e1c909eaabb17afccb2ee4b85640910a624dfbcc46014cc31a59f9c7a93652a8cc42c0fd8d7fe9db71ef1efaca735885ade0169f120"),
			30: sp.bls12_381_g1("0x0467afa8a055fe2dbc5702695ac0cb6890c416f074d38248b1d254daf82de9bcfb229b957d02290b89b8d746e15753da125c749325b9ed2315ac901a040ca463bf1e49ba68ab5d9ccf5530b4f1bd93e0dceae484afe2d3b3e9d79fe44cbbd01c"),
			31: sp.bls12_381_g1("0x0e6f67a4e6ddd85dac9aac727bcf5fa9b39deb588c0688abf08d665785ff377e6f44f8dd88b2643e96dabaa49b0ea7e5173ceec856b068d969573a55102925b2d3eaad1e864b8c9ecb26f821c6c0cc04c531d3ea2bb1a68aa73b6243717c6784"),
			32: sp.bls12_381_g1("0x0159b497a43de43209683dc5371ea9d179b67e3676267e63189f89471358ab02e43379d71d4e69a503061e46f00bcda20b94b3b17652b5fde764f13f5741ccec312ccf75719583fb3ceb880f74aed80fb409c052f5145e0715a285213c3f8416"),
			33: sp.bls12_381_g1("0x0decb0103cbad25d30b219e114e7f1c8b945d3a9bf234ee011b7493fa6b745b5eecad431624515f278954ed543f753cb031b5f243f887198a02f991317d5336c785cc2821ec81c72c6e724e95517d703a28aabe53fbb374a62fa348a2c258b5f")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("DeregisterVerifier", DeregisterVerifier())
