import smartpy as sp
class DeregisterVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_deregister_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        
        vk_h = sp.bls12_381_g2("0x1572810fddb8d5e7c55f39435e952616c90959785b6f23dd01e06652a707c65808c872e84917bc10c42234e0791c6e7511cb592b2c75d3e88e076139eb68948b98d69abf26f936edd60b7718a476f87660d81ea4490393e9df2fb670f394aff6068eb786bf07ed74a2f75a9b94ff57425e04665c19ec7c1a0b6d382491fc3d1a27707c0393df58c7c916cdfec30053880317f4f206f0c53b99a394e2fcf5425d13b97e285ecbbca806db518f7078071a47b38d602e00dc88a675ef0a5b88ce25")
        vk_g_alpha = sp.bls12_381_g1("0x15a9d3b4223611542169ae8abfc5746a585eb3064ad5c8a43dac496e19d556336b3822bb469cc71583ff8ddf21c8e7a9144252ac292dff2949d7af180e30c73a9deaa0455a87dd6e67788a19c9894fdbd34676bf205f880b7e2521aa6df38093")
        vk_h_beta = sp.bls12_381_g2("0x10ff16f94f47323afe280a13c0d5f0725527ac54128d9efb53fc63a1b0d202bab972241aa3bd0ed9c6212adaffb669c30ffa6cb2f0868595f28133ded2f1215d6c7ecf13f997763074c845f910fe592087f406d779539adf58a0909334a903590467698b139ed02e6225904bc9561077a45b2288d3e3e23971af1bc4437f0a593d2e66824cb4cd8155d0956810155ef70a83d68151a399012109ed677327648db5eb5c6c9f2d3fbd81c6ba20a9f13cc98141d075022137ab715ad483216f92ad")
        vk_g_gamma = sp.bls12_381_g1("0x072525ea935450406f18d3a17e159e4ba11aa777297fc3466bc3888a109ed3add3253e83a787c945a0ade62a7c582b1e0d641a937627b2d7e70035d6a367b79f5ccf34916860c1c424d165bbda5eb19c65717912cd97ecc8a9f987762f304ea6")
        vk_h_gamma = sp.bls12_381_g2("0x1572810fddb8d5e7c55f39435e952616c90959785b6f23dd01e06652a707c65808c872e84917bc10c42234e0791c6e7511cb592b2c75d3e88e076139eb68948b98d69abf26f936edd60b7718a476f87660d81ea4490393e9df2fb670f394aff6068eb786bf07ed74a2f75a9b94ff57425e04665c19ec7c1a0b6d382491fc3d1a27707c0393df58c7c916cdfec30053880317f4f206f0c53b99a394e2fcf5425d13b97e285ecbbca806db518f7078071a47b38d602e00dc88a675ef0a5b88ce25")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x0be14a978db6979cb518a1c1dbce8b2c31f047f4a56d5626aa2d6423fdcb10f81eb5a9365992adcfaf7ae4eb683640030eaa286059fc267352f66c5d14e1403aba28be3d47a576c58f26e41f08b545dcaf40aeb8121ea6d52201faac6fc61d02"),
			1: sp.bls12_381_g1("0x1038a88335cc52409699477e4292b0d3d7c848fda3c5e1aeb9cf718af9bc2a84a6e788bdd4309554656d43b756a40ad107cc15078e09ea0bf5fd90e82d0e49f816618b255598a27ca3f24518118248519bd77e306740330c7ddeae9466107152"),
			2: sp.bls12_381_g1("0x0ac0201bb6485965a47070919302a7dc646d2fc37d2771700afc673a09e77ebcb50ac2b8c2f13d6a64a0bb4a84d0658004d4a3b717962ed735ed8d4730e13340b87566f4286444471e7fa78bc87dba734ecb6932f2e65f11f5465891e542c1ab"),
			3: sp.bls12_381_g1("0x0d15378761a85f121e22f74cd7a7051c3eccd81319d535098908184a27f6479ac19f8886532be08ec09131b6f80d6c7c04ec403dafbbd73623aec3137b3ea509f74fcb974d35c229e8adbb6106bbd55b16d7fc563e1ccae5a644f3958098695c"),
			4: sp.bls12_381_g1("0x0b5a856505c296dbdb5a39daf13e9a3a685fa8cce85697cef6837d6a19627aa098cf74c59a2b205b2363243833c3574c0a43bb2d2722bb137a5000d0b9ef3ccf35f29a3d054543aa97b414ea60f44cb4df1ed51237dd85549165259f057604dc"),
			5: sp.bls12_381_g1("0x0c4a83f9042139f1065bbf1e07c351d6cbbf61263a7d1ef0d89f22357a100c5be9017eaf211fa4fa53679b402db86e990f36908a80cf1f06428597053ad7f9f0f07d7041f818443bc6832b395660bb3986d61b8df96828a93d06065a5212cc55"),
			6: sp.bls12_381_g1("0x03c37bbf5fcdb58639a0eae54318a67d48160a0afc6cdeb9d8f481ebed405e0a4421da2029ed9977d8edfeed7eaa3a261202fbba764c66492428e807b2aae615e2e4adb2ce82a44630f3a2c8cc33aae776afad9777fc7ea94fbcc2b5c1582166"),
			7: sp.bls12_381_g1("0x0a776fb43407c78d91199f53a8d705121e715bed29fbc57916fb8aff2ef4c386063a192a42e3fa4277047d35d75efe08192745d7892b33372f92d4f78706a5953970f52523360312a21a22133c5ce62ecdb2f816322f1358b398c5322ff3784d"),
			8: sp.bls12_381_g1("0x101321fa8f22e9078131da3433bce4ab1fa8ac698c970aa0bb2940d4218b6e06ee63b456ee15550ec56784989ed94da50fc8a07cc5c144bb35c457a294ca87251a6d69241a75ceab53ecec8716bbbb43303d9effdde13eb2c7fc47bc5e571358"),
			9: sp.bls12_381_g1("0x18e94c31539e43fba51470a82eea8b5de5e5ad962146411d25dbe0c890dfd8b8fa97e92379029213458ecbd1d92b871317f487c48874945b440313b4a37fc91a1d13c37c56b268408d620d35264cd31da14f905a7d9222c4d95665685ad1853b"),
			10: sp.bls12_381_g1("0x0885f59ae2bdef7ba50e1466be1852e098ffbca502a95b446f3bf51b49756661d4609811ee92aa66877a27c212c991cb09f183893313575b55647c492cf206937f1f77726680cf5554ac42cc18581a47114141271d54989a946034cb67a64013"),
			11: sp.bls12_381_g1("0x07b84695938de6cc1be1b49789a2c43da4b5ddbdd8668ad2057b67b1f9f050ac3279b36f44a9a4449e31506943adaca40976c07f739cfb26ff015400586c3f37065a96fa67cca6de9d06068ccc6bb38826d9d24931a0ef4e6b08bb40ff6b79c9"),
			12: sp.bls12_381_g1("0x0773eb5dc99dbba4ea016bb1bf043044fc2ea1a501f4fe240304014346e61d5d7e60824dfca162ba79224328a3fb0a5b03fbb06a9d2f4ebe54e9432e4c233bcec065b87d347ebfb4a3c7c7d619373228b8136740ccd7ad2985bdcae621786923"),
			13: sp.bls12_381_g1("0x12615daab2fa31affed3f837b35d5176ac9e41ef683e5c241c6ffb9be54615bc0adb05a73669566ced911cb8d629c1ec11b68a8b7fedfbdc32fca0cf272e81aec8124e51a33a72a26d833e65a09f58a7c8570b2c22a86529847e6956583e3db6"),
			14: sp.bls12_381_g1("0x188bfbaa29927623334042356912cf0d10361693fdcb70bbb553571f15e714211305c54c9b260d7df52735eb9061be2b09f8428cb0ed4d9c7ddc5c1c9301faca01e51f353731ad8487a03af3d8c122fea816b4a8aa7a187d92bd2e6c5336ee01"),
			15: sp.bls12_381_g1("0x0f8fab7e4023cafd95e54af07343dbd1786f43ffec809dbed4047ec36323de18b4fbeaaccb27caf674bd5628c73c931c1745423c8585acc10ee707cccad518e79b4673681384faa972111fadb7ea0b05899fb04fe4129838bc35ee9dea5308fa"),
			16: sp.bls12_381_g1("0x0cbf93538c5ef27b9897839fd1dd56c0b6d5eac9334a413510fbb24d247ca2b35ada97573d5e69bc351dba7b5850b7ec18fb671e5935ac3cf183ac0addec1fcb03dd54fb0183a795abeeba0f3339ecc0f721d08adebcd4a0d36fb991daae687a"),
			17: sp.bls12_381_g1("0x078a47211aa32d139032f5efcd0863bc40a0a3b2edb972e8cde84893ac19395c47401e3aca79f98f2e2dcfb2adb70cf313bc109a4e3e547a84510cba46f76beafdba42a5a3453211454503ca6bfdeedb26213006423226e8b2a4bdad0864a788"),
			18: sp.bls12_381_g1("0x06acfbe42bd7af7eaf3bfc2fde9547d797859eaf058af48c59731c0193ae183544807df1245ff24599957bfdfbc454990e4dbb5506854efc6ab307baffcc0c6338f2bea3ef17be5665587da7b66fb5ba9a4a07f2f6f91838d036d01b26e553c1"),
			19: sp.bls12_381_g1("0x15329f0cdd28588d6c31ee910c406f85d2affd0038404ac9a8624641a702b9fd292febc8394c113cc71a6512adc747eb0e796e1446c81fb2cdda93f33dfa7fc0585fd70f42dcc6ce9cc172ee6965c1de41505b013ca6c52b54fa5659050a58ad"),
			20: sp.bls12_381_g1("0x0b3076f3ae6d7812ad1a41cb6b1b4d7532b5a45eebf56995497dec126297ac9e272640fc0b0e185a229e0e47acdeacba0f404938614f77a463701562cbb6eadd17ed399765519fcf472caa9eaa7c346413fa2ad67ed5ee966fef712bcfc41279"),
			21: sp.bls12_381_g1("0x17d8b3582fceea2f85d81f3a3580e5cb91a41ff26a21578408dbe2789e551f3d9bfc254b32f434cf89fc1f524268c43f060c2929cfa10096bc0dbb71f504735cc99129cfa84f7d2b1625b8609e49635689e8519f82e8b257adf2ceb71f7ee8bf"),
			22: sp.bls12_381_g1("0x0733be9bf7d3afdd4c4d8a343c2fd4979c7813bf4bafb4b60e9ec282ca5b7bd7309fd52de35b6cdfc6ea554a88e6065407919528f3208d0d25efdc26ab8aa2d37521f090ba8b2f0ac98776b2968f91895b7cabff779225404889a802a9eb52de"),
			23: sp.bls12_381_g1("0x05b5d4109f92e47dcd52e365102746f1d0ffb8f3d2b91623dfea19e1f6fee12d524688d0d4ee8e5f75788cd738fe1b360ebea5a6bbdcb7974f0898e60df2eea8c5d371efa327f0fe65897fa30b784aeef3646ca295d4e1f48a9c89dca065402d"),
			24: sp.bls12_381_g1("0x019d68fba6227b4355632bd4b8323211589ff1507bfb507278a060a22e4afa6c41454794d777006ee9bf6d39d5e98f9703b6bbc0c549fef90f1a30f93bb7f0823af2f18b43976211bb366030f18b952507e99fbe9c2103eaeaa5055a606b97ff"),
			25: sp.bls12_381_g1("0x17ad432f021fff1167976cb2d750c0dc977c52fd89ae066b0bdbc7530cf76f863bb722475a595dcbef8198e5147d381f067a74ffd9ac84401a5114fc7dcd13b8066f94bf475226e58defc497e7f185f1ed3e0ee46ec88e66c37eb45fdfee90d4"),
			26: sp.bls12_381_g1("0x0f2f3c6f107b80d0a68bc6345a9f2cbab25a2166039d4fb1e696933c96005e13279bc0f657ade1139a66351739e33c6c097a59771a4c80c8e6f6130135945ccb89d08e318c707585c41635ef12ac568e03b418774161150c8286dcefcd5e40aa"),
			27: sp.bls12_381_g1("0x0ba015cf06888e85a7ef1249ca09a887c3e240d590d5f9f1c3a8cb7228a839b8e04c3e1c3d81d6aa43a2beabf62597a91692224af38b9015262eea2fbc4b2ccf865268d5727dbed9df10f3c54ab741f4948a5de72d27476745c1d2c87822afe5"),
			28: sp.bls12_381_g1("0x16c7fe7bf91e660daf58ba5b7d8248c02cd29e2d7a022192090797016ace9bc09a622f38a8ab6944e676b5bfd3f870951321afc24eeaa74938156b6d40b352aa081a2e28dabc47939a6de7aa7bfc2f0800464ab6ffb8ea4e488ab6593b47d430"),
			29: sp.bls12_381_g1("0x0c3b71770e20e357dd24b4e86bf8e42a06b47c220faed71c42ecee15fee1a9799d08f27a1c1dfa4b283a46ec623296c30671828aecb2e819171f77351c28fe55432bdcb2a736a0adfe28906b2249ff8bfc844fbec7fb88688fd9b452825a4fe2"),
			30: sp.bls12_381_g1("0x040b2816304e28f634c8ce286bd6c356cecebd83320d70023203f194fb4925627d06dc3c1adeae082be2e328df713b6711b6c6bd2de3105e293d9381d42da8cc8383e84e88fdca3c06e082e024907011ec4da59d8a02dc81e9b48d65d21a4d34"),
			31: sp.bls12_381_g1("0x12a341fff9066f6b2fc4701bb2f3ac99d1a7e120154e1b6404968060b8d4dac210d880065167ef908d706740ddd454fe16d42e8ea768d8e43e974ba1125fb3b1f8b947edac6e4d9fd81b3e323168964fc2b2c23bdcc1560d2221e0b4f0ab2d26"),
			32: sp.bls12_381_g1("0x1329bf8e79c993f2b0d590be796ceae11d281dcba04c0c12c56bb56d23149d09e3276d319a9aca13fa47c88b53c53f5c040f2ed0f5e35ce7a56303ed96335e570242eaee8c87656a6a913db8713df8e823204fe9caecd69c35c62c8ed6062144")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("DeregisterVerifier", DeregisterVerifier())
