import smartpy as sp
class EnlargeVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_enlarge_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        vk_h = sp.bls12_381_g2("0x11b3d509c3533077d5ea75c1ea5b16dacfac55ea625f4adbb7c396a243d55d554c23d5c4d754b6a02df867c8fca46c7a0fb7899e0f2a1b4905a47b6961ffb2aaadc57cda15ad7a2f7325b07d90b9bb2e2f4a4ede0c5bae2a5a8d5c1409ca9530100b031cb1d13e0f0b6269ed702b2f19a49f32648b9e7c9b9db8ff2fab5bbe8392cfe92e00cd5b54619efee5d662e317111fc29ca30ae48607f6be766d7629d999356767af9b0cb87e01f171128ff61bc6dd48295df9a91957eb17e21ac2b857")
        vk_g_alpha = sp.bls12_381_g1("0x0b252a32f8bb9058a708f1d1c888482bdd7c7c99ab86360080f05e35381058b329a9817f25d3a8234b467f6656b7d2f20805c167f31aba92381a3682bfa7cfbc542d4230b2819c81e346e1bf76e78da587aa006de9f2ac4c99ea3e043d1eb1df")
        vk_h_beta = sp.bls12_381_g2("0x081140c8c69106a2d44a6d19a8bff5d17fe11707254307d5e5a9df4af30db979e4c9241dd1383c80248719e41598b5ad1401d32ac26e1d87a8c900b924685dd2f59c0750fa0424d7769f91e021c98640a8ef410bdc3372a57367ca05b97ff0c619dc10f561b14d5bbcb56fd6ec826ec97d4e267dbfadd7697d33954466f0448d44dd01e41af91492b170db86e81ee03306c836b34c66a42a8fa8ad1f7a0aa58ec800045e90f335f02c8ab237e7b9d5e52587c0be4fb66f51c1b5879ce63c3642")
        vk_g_gamma = sp.bls12_381_g1("0x16fe74cda67e8aa557043a1d9f2c99eda280e8846243ea21c6cad307d7411780b18eba3551bcbd3c2732930836d596c3107593f5dd8d4fe143d3b2bd2a7fae512af070d176783ae6843aa576c2a74450ae230e58d728d947e13459a44a81790f")
        vk_h_gamma = sp.bls12_381_g2("0x11b3d509c3533077d5ea75c1ea5b16dacfac55ea625f4adbb7c396a243d55d554c23d5c4d754b6a02df867c8fca46c7a0fb7899e0f2a1b4905a47b6961ffb2aaadc57cda15ad7a2f7325b07d90b9bb2e2f4a4ede0c5bae2a5a8d5c1409ca9530100b031cb1d13e0f0b6269ed702b2f19a49f32648b9e7c9b9db8ff2fab5bbe8392cfe92e00cd5b54619efee5d662e317111fc29ca30ae48607f6be766d7629d999356767af9b0cb87e01f171128ff61bc6dd48295df9a91957eb17e21ac2b857")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x088bb9a0968b1bfe22d9f58bf3adce59ceadc9769fcce25d9d055fe1864f658850dd49b9b3bfaabd867c08bd86f2f964095d047c32b34d5294562bb0db4a65c617769e76e7a80cd3700766fb7e5b3ee99df6f44112890c984359cfa82e2bd05c"),
			1: sp.bls12_381_g1("0x0dd32252542dee411179981c4a79489e4a98e3164001eb163283452eb27b93975ff360f30559ba95dc0415fbdaf787ec0ce54ad3c01bfefe6999b53e6bd8c0eb6d01751098bc550d28c7d73e615e7b876b039d4725ba0790fc1bfd53e0050388"),
			2: sp.bls12_381_g1("0x19be9403a899811ecb220ee9114916487e5f7aa9602fcff55df5690c87093206ff2f9219362a655fec567b589d5c00d60d0e0a94416c15b70692084a454d6756aca0771ba93995977ec90aef6b9807b43f3ec40c225709cac896718930fc0c1d"),
			3: sp.bls12_381_g1("0x1307db3cb53d271037f1cad8da7e2b7eca9cb0bf079fab064ad7620badf4f822089ae5ab2d836e43fd257729b08ade6018b19d0ddd41c9a634f3c027a28280faba121fe7a1efe69407891be802a5ff0991341efe226bc95f6a2df5d8f8d26937"),
			4: sp.bls12_381_g1("0x198343cbba6b975c9ae6543e12786a38b494c540dce2c11d0d93ab89cac77d756493881cce49dd3f94b1123db28c285010ceb975c5849bf3a500328c4b7169d18d5ca535731d49b82739d9957f9c576e253b3bbceb62c050a4af4a10cfa5b2a1"),
			5: sp.bls12_381_g1("0x0513e63050efa927e1a6cbaff6c836d36a8e81db910f3d60171a6ce038a92a4dcf9466935bf0ae450b09aa6ac03aa7c40df3560dd1472ebb37871b64aaa2bb6d2474d36aa26d9221dfa90fc28bbf0308fe521314bcef0e0370ea641ec03b612f"),
			6: sp.bls12_381_g1("0x0074773336e85f7fd81ece14cd94acc9e4f49c85b13b4b39d79f700a7e870992a1fff86610d1439711a1d136d11b7ad30fd6f2a7f8ff39f03245b33a4f5077ee82683c5337a4151aa56131ed3cda12fc740ef7cf03aa2173ed70afc08fde3cb3"),
			7: sp.bls12_381_g1("0x0f4fc060e26852205c6d313c144b149f0b74d0f69b3712d6f0ecc8930992d2d79751f43b8ce5b397018c2bfcc3bef8961811bddd39e96ee32c6f28796d47f8e73fe6d6492ec15335a46458ffcbd7dcd51079eb132694f99929a699754c1437f2"),
			8: sp.bls12_381_g1("0x050fb1888cc6877cfc9640efa653c937450742c25c5e9cb9cdd1a0dfce0f4b6c0abde2102b3b75559c0800fa3508789103a63244b34c3335d36e7ff54800ed1ee91357107f248d904ead5864ae3c49bbf090703f455547debda17d5a280398d1"),
			9: sp.bls12_381_g1("0x13f0202cf899c9e7b64aa720f65ce36bd7bad0a6421372de5c5733dd3c1fab66895a8cf65ebff8128c77b1d3460f91da18b9dae82e11e056b4995f0e230ea29f1346ef58e62a3a17417753d5bc00ab24f04215b1f305a040de0bf44ce1693820"),
			10: sp.bls12_381_g1("0x00de197e11127d00fad21d4bae4394f794a5a082e11fb3c35bdd1ff7c0f98fd89a4fee676f2bbee4beec165a8265ce660fe288fd6849838b390b063842ee8fd83afad10d18c119d1e1e069568f9af667a905e3e411f79fca70ec00231a88e0c6"),
			11: sp.bls12_381_g1("0x0716d000a6b52088b050a85735ecc584417e67d8a2f9bce433d554f0b0f8045cf94690b31d2baef30094f3132b23c4e20ac494f653ab1dcebe38a79dc26f26681c9d386cb8065245188cfdb93d6362bef92fef6f72d24f771e0ecbf5873097cb"),
			12: sp.bls12_381_g1("0x0b74439422a1f19a0ffc4a92b637c13e9e1c609d41ef3f2faad6d229bac7fcab214b47e8d5fa863034ebdbb26b5e731f132ee9f01646ea198d8d33e16be3497f7dcb3116e75996d6449bef36440d582e1ce82146277b8dd6005b3703eed1302c"),
			13: sp.bls12_381_g1("0x07dd8ee6c3695862503b9a7c1a2943ddd0672c579d9437358908b777f35cb6f0e84d5ce110880896535e31594cea62e6075c0e1ff3bf77f63a38e06b8f51394b52cffc1e824d530ef2d56fec6ba273029d7c46a6030b9bcae29cebe596973d32"),
			14: sp.bls12_381_g1("0x123781500c30aaf87215d702acafcb1d3d8b6a36c6a81d29a5bd9013323f185e8e6f8aa1e486f63687272be3a8d87322059e61019d22c85a787fb62c724498a5dee8efbd45ee9eed9f98461e91eb2b8c70a60cbba831bc93ac91af11db9d1880"),
			15: sp.bls12_381_g1("0x015abca3ec5a775b13e168bbb1e19296f134349312e8bb74c12ebdc66f4f3a095b3e58fceea324a93507ef82d0e07c01174f452caeab0d408f2c65d8f2807c987e1c5eedd89aca302cd8aec8d64c402f5fd08d4c82605836763eca80e4d99f6f"),
			16: sp.bls12_381_g1("0x156862d9c21911d8cb8979c24fca3680d6c38ec4c2f34e401b413eea01fc84440b257275decadbc9ae800b45365c2020172d8ba121b435a23378e36b1827f180532affef9d5b434c10699eab4e8aa233886a448136f0c8b35a3c908a73ad3ae9"),
			17: sp.bls12_381_g1("0x007cacb2233e9bcbb2db131772ab3a1d8d2773c87af11779b1f2b56950719f595e9b2127928cc864e781324e17a2d5ab0a004a74328f031922250997be56cc984f32aaeb503ca9f58f346521ddec865e308f71759b2ba4e38b2f4ccea7d0711a"),
			18: sp.bls12_381_g1("0x061718a6ac6b62803f1a90f281f7cd5f7db851e4004eb720e3aaf4ffe4dd32c5be9b88088348067240c8945923c2a1250ebdc5817a3eb0865020a146fb001bb5a5ac849968fec70c45eac86fd967b3770221958f3ba4a289958bb5b8236de9b3"),
			19: sp.bls12_381_g1("0x07b500abb18fa5977690cf0dcd0b92cbd1f58f83f932d2c6b621d6ad7396933a9863862db7580ee8e0a89175ff7b055a10d53e346585223c56eba9cdaa823bd92f5cb96073762dd5c9bd5e92d9e87808057d7feb92d8ff1dc996632682392aad"),
			20: sp.bls12_381_g1("0x19e148cc4fce3aba75035f4dfd4e2a31d29ae5f9cb7b3df2885d73f51bf191a5646120889431e3fcd5b55d38311558a801930b35a76423a70e9dd87eaa52e656a2edd852bf6376ead6d5a28ed4402f3c9c27e883e684bffe988ccb3bf0762c60"),
			21: sp.bls12_381_g1("0x10fa7cb7831fa9e7eecea7111200d55056f29790b02554b9aa67bf1e5812bb89cc0fe3db13d99de442b49b7e8f983dcb0d9980319b6cc12e4005422f22a0af0302db28dd5daa8ea8954a246978b8b4f070546651d3e16449e22043349d830285"),
			22: sp.bls12_381_g1("0x0057d9b5750f5a5168dab07ec61e8ec27f2bb3d7d339b22357adb0657c9bfd2d574a4e5053f4a98b76f6f382b0c0551400b7647ddf5c89c3ac25b66db2a06024f5fae32d223568c4f71db73a9c52c02a6e8de6fe6a1b97de9369e309a91b6adc"),
			23: sp.bls12_381_g1("0x07d0bbdea660b0f8e0643937eb35a03bdd9107fc59d43a61e39395b308e8e158d5211ccf702a77f5525f50402c82075d060473c98a93a2d681f983d6c59cfae9c3ce43d14a4756fee64164f5aaafa269c7eb7364b2358229b6c432ced95bfeb5"),
			24: sp.bls12_381_g1("0x16b24d2fa851af4627aeeea3dfd6128999593368f65192c9e8412234af4f209bb2a69a5cd0b1832af16503f53d15f44915ff54b2e267e9f84b532578c682d734dd7cce91bab0b4211a900a3dd0550354ff351ff6a45299e8d45b154e960c55e4"),
			25: sp.bls12_381_g1("0x1349c517b0b34075bd9bce86500bbb03fd912651a3c8ff04b73174f3610578169b0a9f0327fae23cba7dc78f2411aea1049d3d19e76be2df96e58e36a1f8e18aaa6ae352ecb77e434771bdd4dba8d34c5973848fffe8969eaca8538ba68a4081"),
			26: sp.bls12_381_g1("0x1921bd1dbc8b0cba3fff8a7ac539c1634ab6e79a11f40fdce07f4345a78ce86e54430c942c547737f677275008d072f31025e0e2cc329b564b687fd0cd82bdccc67ee4511a4b9a7290d88ff873f8484baa7c74a059b7522c4ba9cd1f5d40a01d"),
			27: sp.bls12_381_g1("0x08524aab5b832ffead01cbe4aa28386f4687e8184f64ce1fb619572f9298515c67cf2549eb52dd1cbd1851409f145553142ed229a64d7599e960be4589fbddf6e3e1e6ac3d81c367028b722f0d70a48d4ee5f8d50503b364af83bb45c630c5a3"),
			28: sp.bls12_381_g1("0x0520f3099d7ab84da74e7b3c009fe973f8e2f0d096152885d74ff2dc8c2922f1b7ea9e487fb191af6e36a67e993f41d1187eb71dc35344aff629ee0763a28d8ad65d93f69f15c63f7603f9a5efe897d459a75dcf09baf6377f9541d7ff37615b"),
			29: sp.bls12_381_g1("0x176fc9e4435f9c18e788ae2f47174cca22673f63a3d1ee8a226916f47c662712a7f2a481ef4cd014d0cfccd803a995b704f536759afaa0044c546a58547831f4cec4432f501f1d0fd113e166d03e6bd1ac8761182fc09662d1ea23486a3296be"),
			30: sp.bls12_381_g1("0x04ee624e39f7f16792a2904b92992a58543ccb0213a1e1e6698fd24916d859af68359987ff537ff278991595dbb7ffcd08da90d5a0b43e01ce4b5440b1521a9711551344bff1a50db88be14845e879721e919f93f6f8ff74fef2d12ac02f3136"),
			31: sp.bls12_381_g1("0x02e3f9fca76ada78b2523eaa38791e401905e0e60849d8de53e9db415fbb1c50227792adcfb964ac144bd2e656312f6c04ee15e88c62caa97766851df3919269ff9d4532a642fab4f1ff45ecdb3cf2789b4eef4b5601a03bad0b6ead96a5c1d0"),
			32: sp.bls12_381_g1("0x1070a9b76323c9ce9a000f97d491c4043866b09802ce9ffaf5bed971eda8e728ddd44d713d83c2151f196841b6ddc3460121600f004492ef64cb40ff6b37e6718dae833ecac969f950dc83b2b87f386a131649edf725848e59db8c4110e5d777")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("EnlargeVerifier", EnlargeVerifier())
