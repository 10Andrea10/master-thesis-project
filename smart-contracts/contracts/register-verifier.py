import smartpy as sp
class RegisterVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_register_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        vk_h = sp.bls12_381_g2("0x16b68df6f59462f4955a867cc207bd0bc5b57f9416fa0458668e04ee5f7557543b95eb6db6ce4c23626e99ef97e104aa06383ba31b58ac0111348b324df3b9503cd5b6a580e527843d3ea205fb28ba7c8589d919606b9508a1d1b67a8016185407d8d7bdb7713b461f7485a3f4f122644f00e73d737973ad0ba007d4edca8bff33ace4ab45d76b14c1a5113f780e0070168217c55370de2c58b7ed2a3936c634e9973e78404ab475991bc7e9c2c163fdbcecb6b55c82f88883af059afb4851d9")
        vk_g_alpha = sp.bls12_381_g1("0x0c6ec20af8fb7cff92ae147573ba829f6c041c4926df75c87fb27ea59c787df292cb544fdc3bbfdc402226f3b17b37640984db5a7ddd13aa9cdde86409fb368752535f03949281271bbfff411fe41e2a4602a4ad86bc524821cdf46e21914dda")
        vk_h_beta = sp.bls12_381_g2("0x02a55ef3187c4f7176908030ca84ec0a680b2ea6aca056c3cd289beba0aff99f0a36a10088164308570b6f0fa9b80cde0ca8297521a8201a7a0178155449bc42c030e8b249fefecc604cb63c3f157d88df3a1218caad7420e747c71d646c887e0db39d128b7f836afa1f4d642cfd5100816db901f097a9034b93775ea5fab393eabb1cb085d4b30c3918153ee5d8f0101646cee2307181d59df69fec0c0fca7ba4c9280626c52bf23883de7cf1eb3b3b4380f14478a9c2d0342531d7999c2486")
        vk_g_gamma = sp.bls12_381_g1("0x132151963815e3763a81898b0213f48dee741873be069d8ca4d35371f4de13ee223d977b125e811ab5f45fe144f07e7414fbd2747895281e8f8e035b89c4121d6e491419c66772434ec924ddf891344cfaa88193c5d1e741ecf0d27af7c9375e")
        vk_h_gamma = sp.bls12_381_g2("0x16b68df6f59462f4955a867cc207bd0bc5b57f9416fa0458668e04ee5f7557543b95eb6db6ce4c23626e99ef97e104aa06383ba31b58ac0111348b324df3b9503cd5b6a580e527843d3ea205fb28ba7c8589d919606b9508a1d1b67a8016185407d8d7bdb7713b461f7485a3f4f122644f00e73d737973ad0ba007d4edca8bff33ace4ab45d76b14c1a5113f780e0070168217c55370de2c58b7ed2a3936c634e9973e78404ab475991bc7e9c2c163fdbcecb6b55c82f88883af059afb4851d9")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x09accd57c3f3eec8467530671984bf918f39352efe2a7811bba6a854f36d59b328d3ce282f7e1e2b0d0971f745b00c5316e29455ee078084af4c6128d73906d0f7293564313e92305dd95c3b645d4636bca515970b99c0c877ff32eb7f8ceffc"),
			1: sp.bls12_381_g1("0x18a49117021c9749219fa4fa6c8fb84ad9aaac74c18a49b6712adff704d3ee422202f3a3fb9c9e6077488388ba5265a9051d4d6a117801e588650151e3e6d029078619ed13c8ce33424f085e6dab0d4bc629f8ea85330f258a14920562918a24"),
			2: sp.bls12_381_g1("0x13305e3baef449a14e696bf1dc8acf88d6fc6237580aa45844744b1ced4ea5f424f8b09fb1b367bc614b242904713b3708b38995761d0e9f091fcf969fc9d5317efc503a55ca3da2238d8e66edf75374b5f6a8f1fb6267ebf1907c335c351aed"),
			3: sp.bls12_381_g1("0x1871df079a647bcca7b84b8f82dd15035093d505a16f9c656b5463241215721dcce2e5abd7d94e4e0ec5c75f70c4edf00ff403683cd467d6774cdf394338e2700970f59d2912258751fc4c7041e4750c4fc4422eefb66815b273ed6a0885ae93"),
			4: sp.bls12_381_g1("0x00b4f06c4920018643e60dafda946edaf8d3bfaebd85eb09503a987f12a22cd807b80223d72e04e8ab242942842c50f808109e2c23a3ba41e3f5d688203a7831b434c199d0641d51dc50d4a028f2fb6c2fbb73a6c09a0a2406e9ae11355c6f00"),
			5: sp.bls12_381_g1("0x02d5ec08e7c97b70e934aeed2dd4a7489e60067b2e3527167f792c18e4d09d57fc1865a0ee1105ca448c7b25a39273ac07cd74951d232e70c87de54b872816b881f3b47c69845ff0cdc6e9e728045bfab5906157b9be776073a0c34b9cd34303"),
			6: sp.bls12_381_g1("0x0e9181ea0280ab2549c03e725e0394cf09d2b33286304aaff21dbeaac2895afa3b53677d60cb76af3777872612b0190b145138115637b9937c9fdbd389cbb899be819d77b67c8676fd7f00dfe0ba0fbbe6e4e5ac5424056287c1576f50ea1742"),
			7: sp.bls12_381_g1("0x11d3e2efc777a37c3903d9efcbf28bb54c956e1ca91f8f060b9f13049dd65d022e22c726e8ab026651816339efbcbd0f03d90b7110ead186f866445e01d3cebc0a3a485c0a39db6c575e1d615c0d9feb4160d103094f4b3fe07eedc8d2ea4441"),
			8: sp.bls12_381_g1("0x160458076c5e1f39f42f0be54a57535b683ee0fcaf981d56f2fe52224c0b6bc675f97b8aa0a18b3edbe1da09c03798df19d147b0990c1404f79c5fe83bf8bfada5434be09a7004020b9976d348dd39f279e2fb104ed93688d2738d68477cf933"),
			9: sp.bls12_381_g1("0x13f570cee4e35d8a7baf52b51cd391d35767c6fa23572597c2873dfd4a22b04c066fc23d968fc23fbd7f2d97bf74440b1077f6fbd6d8bc9fb1b590f7d7d674da1d1a1c60ef6eed9eaee88f3a55ea8e99caf62100aacee81ba53e95d91ed6781b"),
			10: sp.bls12_381_g1("0x0c2846568683106be5b5efb8deb4eab9feac9ce03ab6d7ded7336b7a27f5628cc33de7496ff83680a0bfb898cc93a26308cf02b2548e98d8a063e6e8bb7e391d7e57188009b865029e9932667796d221a49349b3eec40fbd8aee9f69ca30b887"),
			11: sp.bls12_381_g1("0x05aca6a9b99eb2509dd5532bd1830201172f802e9efc43d61cbd1ce47da34b78a258d192aeecd022176d39a3bf69fac309bfb7b7611d43afb231ffaa68feed0f69d2e9c316cd6877693b8e597ec87290be74dab757374b36b1b2ad3e554c8bde"),
			12: sp.bls12_381_g1("0x115a513d68e13337a973cbfc27bf42f14b5ce0835ab75f5bab79446dccdbd4ee2ff2687ed93cdf30d5e218d49af443c31973dc525a88432a838364ab628ac050cf339df3f4779164d30945fd09ab37662c121554389de797289133e7bef9f16c"),
			13: sp.bls12_381_g1("0x0aed7ab11278a65c8a5603197d6591878e56835c1cd9b487ed8e9a3b66d58451b44763c2db4192c5c395270d4b0853da141ee019b0c988fc8a153d83ac45c015a53dcd69d6370ecbe3fb03d08001bef239393d491aa583c7d81e39e6a10f8ade"),
			14: sp.bls12_381_g1("0x043a37f8262719d2a111fb28815e981d497679a70973858ad12ed17ec2e4bdcbe3490a8d8ccbc4f6259a0f92c47c78911940863a3e237d986728d2ace5fe3c8602ebc6a133fd051d2f1d09f915c62330f1cdea267ad55fde9e1ad028b776136b"),
			15: sp.bls12_381_g1("0x162bbbca95f9aa587e025fe928d90b7a78821862133983166d860a1851bd3d7879ef05b07672a80a5a76fb9aaf09a77614253feb5ce70db5c8f6f4a8688db4fdc67c69719a2962f20e8d915b267666a438da14df86b4a39585a3e4dc50b74c86"),
			16: sp.bls12_381_g1("0x08168c822b9bd4a3b0b20f7b3cb5eb06bd1c9cdcf4900833878352dbc5d570adbb96db9af6c6f34332158d311c2051b40ba3955e6001672ce46a7d8ba3581acf4dd4c9f607fec7ac5a9b66306f70e1b2e14eb1a2931a5a4641684cd3d23554b4"),
			17: sp.bls12_381_g1("0x111984cf15af81bfb310446bc5ce470d752b27151e0dfe151a4e3c236069efde64ea07cf8072188503678531b60008f804b36c035c8c9b52111cda4bc8a8c7389eac472ab5c432aee7aa22f04bbf4357895efe7f6f8b9c0b2bd5a14885acdb7c"),
			18: sp.bls12_381_g1("0x191a3268c422aba0a0a164b0af24e691d1dd9c809a6a46bc75c593b8016340f41b45796cd9bff551590eb2d85840bb610931c43e87ba4be149cf8508b56db7f73897787880a330c0cfb55de3e5edc6de034f27964e017ab9f28571bac57f8789"),
			19: sp.bls12_381_g1("0x124a151e6b64bbb022157062c8416e710d06628e776e9d4917069add4457d76da79366c06bc58ee200755795d45c6c4116f0a61be7a11960ab321a2eba2e299e9f0db670a861eb295b670d023d8c1694a6058b215fe6d022fc92fe71705c03ca"),
			20: sp.bls12_381_g1("0x0b91cae6848e8fd1679c22d0f1a9da28dcc70f32b333528266b9950efbe71f2ec8381f6fdf0defd93e2260e060c9827d0f46756dc004d060fab0e61cc26b479ab88cd277612423fed39198e55890145d8c7002c6accb542786355e727214631f"),
			21: sp.bls12_381_g1("0x096db089bdc68cc5c46601d2718f3e495c2a21b34107c3006dddfb470166dfc77ad7c07ee5941bf32b61231e59dc3eb502a16d6577d7f5a74a117698afa8742522f2a017520b757881f94a7f045ccc2acdc47fd7ba60b2aaa0c2b3c1f5435b01"),
			22: sp.bls12_381_g1("0x0003f989b7f816dc284e1cd8a67071804bc696fd0ddae4d20e473a8434f78bcb5761fcd14a0fe96573987bdf350dfe94054a482d12b065e25d1aac23dece8c5a7b5f5798792c45a0c986ed6c231d0167b4c0e803469cfb135919bb074c00b37d"),
			23: sp.bls12_381_g1("0x02bdd10e440dcc3c777aa72c9040516dacd5bee6e393d34389e6554f51d011d37f94f76e8c5f2a5d3268a2c35ef7c54505066dda1939f4ba542f4031d36061f7cde6f09f5a0c72f46b91527c6fc0905a8b176ddd57d7a4454ef038cdf7ba7d42"),
			24: sp.bls12_381_g1("0x0c1e0f43fde7cb2d83b035a17e1ee856aacfa0c3f7740a01c4374c9ab0493af19a8fb427c23cafe12db872d289c11e670adc7bb0582aacd09dec6c75b0d6f0ff79b02c60906984a937f705ed67a56c2166a41175ebd84c684809067d4b443874"),
			25: sp.bls12_381_g1("0x120020bae8698563d2e0ec5f4d916b2ebf42a7f27dd74eda44ad47eafcf635bacf9dbd8c14e3621021ffb1a07cc8a69615544d5d0819a7f410e4fa78e053927c7026475ecf01239382394b13eaaebd925782c2b1614912d59cd7bc04303c30f4"),
			26: sp.bls12_381_g1("0x1735bc269ef1e29d0d5fbfe846e887d6c6ceae5415f2b6ba53e75604e9df7afdb30f0f8cdeb6a94cb007f722f11a7d8c11474953a626cdbecb849cb7fae3589df91a234a96a2a85fa2117790e95530a6893cd244c1948837c70c7311c0a0747f"),
			27: sp.bls12_381_g1("0x06cc751b946d06369acafa7865112e67408c9eb90abce77443f5ec78a1f17e453721e7aa2ca2addc2152768e387e4049097ec0f6d63fca67bc32f5095b95cffc16a8861fcb3b0c16ecc461146b311eccbe511373ad732eea1d6bc696ef14ec50"),
			28: sp.bls12_381_g1("0x00d9afd65dbedb464af2a77941fb8ef34f90a6f71c5bd7f1f5eb6439532a00b3638caf41947e572a0c0b91130762322f1341140db294bc33d52781e92a3570f2a030d2c9c2f27db2f377d7f02632f6498e8a9dbbd1252f02b23676adfd9c5929"),
			29: sp.bls12_381_g1("0x156866be4899007162c02d2b280edc4f55c1e6ca531128500f36796a5c59e730fb8dccffb52f25138e0f99f028f6a9020e62bdde39fa458511ff60a11c9c306f2fac283a1d32ea0d4ddacf0a89112c31a35d2a27acd9f1b92e82134775cb9a7b"),
			30: sp.bls12_381_g1("0x0d8cc0e51bd6c4e08f8e0fa506c24977e51fafe887af956e1a627d2a644bece50ab77a3bb76761a4b993844fdc05a45802206e7112f8cdf4728847ad1473c1993d28184d18a8486f24a43d145f6018881192f6d93c0139d262b88b6eacd1e661"),
			31: sp.bls12_381_g1("0x05388ae99041677b772af32c5151ff235d0ebce2a95b3e82ad5ca3f36590c5078bb187ff2d80e9e395e6e6ebd3f624db1734845ea1621ea81a41b5372073fadcf011e6189a72f902e1675af1960b4f9cc4f7179a878126782af412a92e012675"),
			32: sp.bls12_381_g1("0x0147d338ddaaed622964cbc1ec606a22e987f719d687576ebb44bd8c41a59f2575b045c7dafac6597f29ee7aba0c830a14d5b908b2a0cba81e3c5384ce07752568b90bba66251bba64108738ac1cc90486e0fa9e3849532151f6effa080fcfc2"),
			33: sp.bls12_381_g1("0x183210941317dd2f6f82d83e20f759e0f8dc9b0473006844dbdc83a1cd4a06eb2a9ba30f817270cbbd94206cde869a3f160324755890f367330775317297d1cb4dc0ffb81ecd8e9ed6d350af2fa14855a1c3b5b230dfc948b9f3baff52b52189"),
			34: sp.bls12_381_g1("0x0b6ea3c5a13e630bb97c8f91d3f72a44f4916da34b161340474626e0671ffeb2781893d38c62c1cdcc47d4aa1f595c2b0d6d96a6f9eeaa5bf8f23adfaa532d9eb72eb1ef0fa3d612e713c3f34816948f0c6ed61df388822eb2e454c63030bafd"),
			35: sp.bls12_381_g1("0x0f13de93f9dad9ec7613505f2a806fda572ace47e050a1b122b3031dbcb86fffd683687729e1acd9f1ba44bb1718a42509766acb410aa4e63f113f05c7c72d6babd6b640b1257af523485fe20f178611ad7425606e82d5dc160d4d02996c2c31"),
			36: sp.bls12_381_g1("0x08eb3ba4274479ecabbfb964744e95ac32f5cabb2eb61b9fb4978875017a830147edbb3daf59c91f91052a0753a6a330020b9be7cc6e82b3960d6e9b898c14c2de91c2969dc06f1a7d46e5f54934422a64a007953e264ba92e4f57582310d692"),
			37: sp.bls12_381_g1("0x03e470278ed3232fbf309eacb0c0fb467aa4350ec403adcda45e6e40dde1fe021e079a4efb8ec354462fbc7e400c62ff148565f1283f814ae6f638fb525b83f0b766c40775d101c0b18f4748784626ca590851a50790e6d5c2fabd06dba40253"),
			38: sp.bls12_381_g1("0x09d9b5a798be449af9d3daae7f46db5404edd61156958bd6112ddc63d0f9978796ec9c6127380d36561736c2dde243d207c4a37b0de3ded2efbff219be5edb0a1c96442aceda5293084ef4f4a93e5de01e1505949d2629e0b478b9f4792b2896"),
			39: sp.bls12_381_g1("0x0c94c112ac8320723cbc349ace2161999c54f43ea46160dd461a198915b3f919a47533eaf2a65b70f7c2a86ca5f397221005e81872a3ba638c1bf9507b36926b1195ab7634e33f24d540c54efb238b7851928a7d5eba2830314f688a40798b28"),
			40: sp.bls12_381_g1("0x17e9d49b2d73496dc63f6cad44d8bd267cc10f26db573ab5002eeb02c66f8f09f178218584cd3235e59c4fdcf736c9d00155dc3b531ab6f8aec912d07c455ec1f12e238edbf370ff492ebfdfdb95e340435bd59707f792b3d4f68111d5f6d215"),
			41: sp.bls12_381_g1("0x05c109c34e667ee374f8a25d0a20ad42179e82d489be2aba54affe2649bb5c3f2576c0ef0f25e576ed33ba03e7499ede046b4b1fd2b9d50e2e99ea7118e33fcf5ff4ced81b7ddacc2e2f46b1280edd14ee0f31c07c95e099e217d18e575cd711")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("RegisterVerifier", RegisterVerifier())
