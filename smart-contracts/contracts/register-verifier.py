import smartpy as sp
class RegisterVerifier(sp.Contract):
    
    @sp.entry_point
    def verify_register_4(self, params):
        sp.set_type(params.input, sp.TBigMap(sp.TInt, sp.TBls12_381_fr))
        vk_h = sp.bls12_381_g2("0x090f300a4fd03378f3ce87780ae628aef07775cf41788125236e54be8aa8d457d34f9e20eb8f339f67f5fb84ac524abf19c36c41b40daf2f7340a7f6f63146c477a1b5fdc7cebb809ac7698a04ed09631c31808b3e87e8e64e439c3e5038d49e01f2250d41591bf0e52aec247e94e9f2ddffa865be44a34fcb20db9b094b3e75c82e44f5777702174b7dee532343901103e93d8cc289d79f45f260d0907d131bff8a1809ced033a286782d425b8eaf326acf99573de1c4672a810a0bce21089a")
        vk_g_alpha = sp.bls12_381_g1("0x00158a180b99bc4f9ca8f8dd8d1e9dce3951d6392950fa84276761f77f507544e02d0b11b162904390417ce685148b3118b8a8d397b46cc4287bf19c51f66b1dbdb972bfd5d4d6660e267f0db87a553d93caa943d7e791da7e52d9c0ef0cabed")
        vk_h_beta = sp.bls12_381_g2("0x01ab48e8c1badd1817f057ecb23013360463398d9ea2eb0639a0b893181e04e378874d53b4f6784dc20b8a82ca1df0e614e171d57e8584227eb8957148cf38fca7d13d9641042a42a6ab15b1ed2ea6c4e13e0219c0255fd3e987769610888039176c6b1bbf503b01b3c14459d9e8c2570c8bd45c3f2c24cc6e61c90410bfe4f1eaee93c3f4c2bf1ed509c46a24b73ffe15e053d7805b40851f6c4206587a7a787920e93b39b4b371aa55a879b6f69b0cedcb56b3340eec78484655e801bd243e")
        vk_g_gamma = sp.bls12_381_g1("0x0b4051bb447cf95ab2480132cdd326042967eb0f158b0aa01c93ff44850ddaf121d5058a77d0a33e6b86d07537893d1219540be720f0f2162ac35675f4f562465deb76596589d365e88ed2b0db57d4a79e722f0a5f8515ac7b3cbe4a02e1c9f4")
        vk_h_gamma = sp.bls12_381_g2("0x090f300a4fd03378f3ce87780ae628aef07775cf41788125236e54be8aa8d457d34f9e20eb8f339f67f5fb84ac524abf19c36c41b40daf2f7340a7f6f63146c477a1b5fdc7cebb809ac7698a04ed09631c31808b3e87e8e64e439c3e5038d49e01f2250d41591bf0e52aec247e94e9f2ddffa865be44a34fcb20db9b094b3e75c82e44f5777702174b7dee532343901103e93d8cc289d79f45f260d0907d131bff8a1809ced033a286782d425b8eaf326acf99573de1c4672a810a0bce21089a")
        vk_query_not_local = {
			0: sp.bls12_381_g1("0x1009ff27d906e37cf489b1560815708f4a2e1b12a79be181993c3030e74cbba77d7c0d4a4ac9125a9e1b1089569037ce084e686728ee8ddfe6e156cab17a74fa76bc0fde5f558d1aa5bbc02796f161e17cf65f9fd53840e962c44037022b4aa7"),
			1: sp.bls12_381_g1("0x03c40963af0ffaa19fb9c4bfa06866196da14ec2dae1cb0242edb4d37458fe73c3bdac5c59281d1ca407a2f167a086570166d8503026cec8c34512c9363923ec38dc2f5328a8f46221b32aacb4c9df07a003af6beb62878074fdbedc4a424b16"),
			2: sp.bls12_381_g1("0x0a05cea779e3535cfcfedec1854a5a8588a86a7920d14fc690fdbda38c30ce0e5fd74d9290c7cb8cfcc22a6bf59a62b60f148da9521c3ed0716448be1a493b64ea58e2d4978b1668afd47b14d103318a6af95ea73d34ad6eac271f3bfc162523"),
			3: sp.bls12_381_g1("0x07d327929278ed694cc58708c5817884add3720a5abd4cfce7a214b9f27a333828257d18c54c43060568d03364aa1b001503598ceb7544e96ade9caa7477f56f5e3875d4c0728272dd315e8eb84444964731d60a592119dc2094fb181dfcff7b"),
			4: sp.bls12_381_g1("0x0bb8778f9a64a49e0ba07eb0550871ab6a1440d801b54e2ccc8e30f0c3b5958f82b52dd94211a873b82c5efc232f997913148594aa8de52a6569e24be9187efa1ca5afcfedb1b67ad22e2c601de7cb529edc6bdcf0d7fd0bc3e11367adc2ecf8"),
			5: sp.bls12_381_g1("0x1092e6f975dfb9018adb11de0e218805c85a1c0c7dc56a29a1a84fbe75946e319750c321e16896fed353309cb56b1bf40aedec59a913ccbb8a7e81ba9cd639130aadc257b889bcb62819227697038bd594feae09c6b3229698174fa39e6043ff"),
			6: sp.bls12_381_g1("0x060e3a88d4d9f20b978afa1229059204a05c3df4d49f2a7915c7bc7d11d008f9fafe7ab8d7b372ef5c45e94ee3958b990aca89fa49ec2a36f2630dcc73089c904c98e35b4f948c43d3c94442e3229b198dbbb54c927e8139d962fb8b1ad233d6"),
			7: sp.bls12_381_g1("0x088caeaae444fbb6c6f6b604d1293b755b3ed6f36646db23a792523634fe99907639a4a98a374e97ab7acbf971feb470056ee02bcbca9886698b5e77e8944ccc7d6136ce3f15d3f29e03db9bd8aa2ed9d1e9da01df99977b1fec71277a74889a"),
			8: sp.bls12_381_g1("0x05208445e2b0fb137b6bc813632daf91e2839850970d153d67f0bcf22ca8621dcd88a1b43b2e3319e989c0a8897894bf02424cc839738912bc69d35c72d81ccd7be8ebfb506c6748e89e822f7dc76e1f699ed46c544c5cfd4415a9fe690ae7a3"),
			9: sp.bls12_381_g1("0x0eeace89c2ace62e54facde0eaabeec7f9aacf7d3072626b8c43933db0016f408d16a69ef6f2a1619b68c65db5d679890422d7ddbc3e0fcfc1b81606d7d1eb11614dcadfce831bfc0970594208c6dba68e03f1909be5430010030a40c6ff904e"),
			10: sp.bls12_381_g1("0x17607bfe0f5b8f3b54863a2e3adc1497a76c2d87b76834052d0758b74f9a4f88c2ee4f70c86255eba4136590d0d6dcd81012652ef4a354dd2a0be7345df8fcf58143dfc669009e9ef89443b2de8feaf14cedbdd1139647749cf321b97f3178c3"),
			11: sp.bls12_381_g1("0x0bd011e883019d0108a32c1b3e8499370008fa43073d86066f49a2b31f48d8bf2efb071c3293bd47e845a9e1b1bdbd100ece87abcb21ea6c38fad3fa0a95f7db05e93f7414ee5c0b60706baf290c5c9f38905840c0bd5eaa8261ebac1c7441df"),
			12: sp.bls12_381_g1("0x1559feb6a87e310855725abc3151a1df0cf5c9ce5001dc8df3f5a9ea1c4ec24b15a9935c169c9cc2bb238419efc55d530565f16c8067d9715aca3001e4559e3639c258319c6ada1812034a926ea80485318e256d0425b86d16914dc81a61aec3"),
			13: sp.bls12_381_g1("0x0183656ad0acd3171ae9553a25cfea33318b691e693bd28a5ba69af1ee80fcb243623069c1bffc0970aafe06526e46850ade69dd236b4b077936ac89021c03248235642d32d734209b64a4ab44a640b58097d3d2437481714f4779d02446fca1"),
			14: sp.bls12_381_g1("0x0d423f3604e539bb528f4fbc9da7680bc08040c2ab00410a50c6a078179fcb07dfd34eec14c5a592f0eaf49efa1e004a13a1f1318ff585cb77022f909ca6bc9206ff74f8282679bc7247ff2307422349f7e84aed6123785b3b89ec6465e82337"),
			15: sp.bls12_381_g1("0x0e424a4bc5f30936f3d58db701d88582a2c88e3f68551ac4fa400fc51512467b315e340ae2a9eee27733cfcb518495850c0d4d90dea81e040d576be33ac168063d28917cc7a277d7e5bcb82ac2e913f100cb5abdda51e5744c17ec6e25ea30e1"),
			16: sp.bls12_381_g1("0x04512e3458e0858ae4d6240a304902b3a279f7449c4e8b777b2286e7b4cafafee8fcb0861e4da4dfd632628bbb261ed613d9cea9ad07d51ed35ac6fabf6b6cf151916ece9dc9629cf1f9e8a5b4953f939bd337745b5db3f369a84d1e3a2697f4"),
			17: sp.bls12_381_g1("0x0da0cbf6b80cc734361bbe74684bf74d72efd9cf7ae4cc9bec9a38fee47478cff250f374e09e37881bb05788d8c5eb53021b97ada057c94a50c2745bea9626edca53522ba275523651c8b139cc62560ff31c78e5f2721667c2d9e9d1575460c1"),
			18: sp.bls12_381_g1("0x02c3bd65ea3848b269bab5e2c3f13b428b2926e95c55f2f00e6a03d6f0e58b2d58276f680d36e1ca746ba5b9355fa60b173bdd2db097f446757e6d5036f4e49f96bd822007952008e3369708af3bf709eea557a303d97b01ad12d25238d09d56"),
			19: sp.bls12_381_g1("0x0575f6147d9e4e65b2e0c83168212eb04d484104e2549e0f9e9ad3588388960672325614acb1029da466e7a070a0141515d52ecb858ccdf508e4864fa30af201f1e6dce2641089a30e8b749f25e3a92e240f09a282a18af0b9e5ff91c6c3f7f2"),
			20: sp.bls12_381_g1("0x175b6412ac71facdc035e5350bb33f50dd7dff000e3b991c239a6ab3e4cbd2aa031e7bd90ba46897c778cfd2d40a2a300ada6e1291691f508c3e8bb559d4320387d6dcdf921735e62faeae3c088d9d839334cd1dea8889a347daeaa37ee74d66"),
			21: sp.bls12_381_g1("0x02eca35d18ee6ad148890c8bcc253742adbb16fc4669b6576f6e6b3a83f79a152a5881e9dee6eab7f63b5342a4f9884e143067dffd9b64412fcf8823eb4792d0593c9f0c972a57423281674ca4476d65e9e7b5653f2821518cda283715b31ea6"),
			22: sp.bls12_381_g1("0x0e9fafc50d928957061668c60d721fb3732796c7c15bb9eee2135ef0f7e399cd46f823c633e52f1469b082a45aa8408c0b5ced8ff5acb84928e2b7053a62f7162c1f65b0468c5a92d9608363ae988810a300fe95fa0bbded148523ef3b8a0c53"),
			23: sp.bls12_381_g1("0x14a6c5e5d34cc27636fb2ec78d6d33bff658b23176d8c294c3fce6756f83bf69b97d625195bb7b5dd983163d4cd903ad0b3ef6621a0ae5fe303eff6d37a16ca77f43b7c2b6d38be0ebc42d3ec55986cb34d8be53688f2deb0924a75068dcd0fc"),
			24: sp.bls12_381_g1("0x083b3972dd18d8b9a0bb40c19653df648e233c7cc5b71a2e3ceb2d161e1fcf15eb76b5fd8d3247e08a0755cfa8c3561311b2c0863552f7144101ead7736eda0f027a5a73eeaed26921372d5d12f9aeb511b985e9bfc91c64090877c98c2d8855"),
			25: sp.bls12_381_g1("0x0b08b26e0d89cfceb5448d5314d465d668fd2ba433273ceb1855cad9130060939ec8b5c79fc8309825183fb7fddb315a0078dec212b1afc6e5ae94cfaa74c4b576a470cd0debd45c93d875b48fa0b22dda54e02a8d90634f56d7ec70b2c30449"),
			26: sp.bls12_381_g1("0x16a5d346626bcd71445198c7fa002669d609aab4f0f8c2ff6d0f25b13192d6e90573696eb045d8035789bf6e9561907d13b74def56d0ac2a49c072a0c00e641c0f6dca73b747cc796fe9e93c7bc2bc4e37d9327b9175d031d4dac2fe6607fc95"),
			27: sp.bls12_381_g1("0x16fd31960ab1815dc430f840011eda12f16d0e561a94d2b6291d64ab560b185dad2280901e8c79ae28bf8a227ac4c70409c3d8627278577a3370e512f833536d6df896375ef237f4bcc9beb909d9ca0e0586ea3fece956478dc480b30cbcddcc"),
			28: sp.bls12_381_g1("0x087d1c558a82d1b342b288f63437c5287eabe205ff61da7b7d6f10e82a611d2333b0bb9df0f5b99a6ad6b3822b0364910c5b5194e81a334bc0b51c32cd6a195e654116208aed8d6eb68ef7aa8bd804bd23dc3b7db29cd4e210928cd199f4cbf4"),
			29: sp.bls12_381_g1("0x19791c04ca424936cf66b00ac178d3f9e4efa9f10e688b2006dda53a5470e99799ced0e38fe6dabec88bf5b52c7e155b0612a2d92e9d652997c152e45eeb77f20b5853d7399703b2f0657de2999063a27dc1ef71bcd8179258c0e2f0586cb13d"),
			30: sp.bls12_381_g1("0x0d9d5a1d245be575eca5a24e5fdf1cf957a700e5b3bafdd305217b9ed3c109ecc9b8b2695fe972bd87e6c89b32bcd19c0b056783c4c808a98ba2e4e54c6d0c84395b3ba0aa947219f25453d4478207712b28f20e27e6bd7b334ea00c8c80ba67"),
			31: sp.bls12_381_g1("0x0e7083ff378f07bfd607b983922c97313ecc8b819e7e23d714dda7906f8cfe2a5654cb3144734c9e9b9dc3952d4a8c0614ffa9842733e578ea53cc6d65b66bcceb28f22cf5c52407cbea5a4b48727458de413fc282a41e72e39e0b490393c809"),
			32: sp.bls12_381_g1("0x12432a3f235ec40dc4185be26cca295ce915b379f52cdeeab893bd44a68ab4a210ed04b22898fc126b828a9391688dfa09daad6835a579007d4f806152131a0ad6443f3018304500559835d8f9241cd61618ac343d64836fb68408a410028658"),
			33: sp.bls12_381_g1("0x12f0952cbd214b985f69aa1a710d01676f57b0e022fcc57ce2d0d25b43cec00e6309d1896a732e4fe0de82856354f6e408658775f16f9d9c89d8f3b7314ca7257231b0492e961978e1b253f1256cdd0abc71ba4bd4ae28efb2788a528fe2f809"),
			34: sp.bls12_381_g1("0x03cbe7a635c4ddf0c168f30d93db7b52ad8b6621a827bc34ff0330f9ca763c4206f62f8d69cc5e0dba706050b0f478b10f16c23d13c4aef8439fbc7a2e9b5be4c99ac2b34ae184816b9431f46b7fa5e4a3965e12678a728085a8b33ca0d20b1c"),
			35: sp.bls12_381_g1("0x112f5c3102366d40427847b8886012eef9dead3a80e7ac781404cfb4d1424e1b3a95762d99b6f0f632af267b8e163bc40069e2d269e0959baa50968a9abf8e7c4d3947200da54ce28f75f6076addc13bc58a3a8d85e996b601ffdfcf05357d78"),
			36: sp.bls12_381_g1("0x0ae31872c4272b6a2838246ed2178c2beb50b2f37131d1331db6aad4d8dfa8e36552bc0f8baa6468ee065395f984d2330299cc4d0c693f3d23989d4cfe555d917bc98f692033589acb64777abd81a7ac43d88b38f3c32e884c4a3910def76f27"),
			37: sp.bls12_381_g1("0x0e41b5e566e93e59ecc1e420abf3e3f5a333aaad6576ec65647be5df72778b99937f47d5a21cb842e2ebad7deca417f20dd2cd5afdeace8ed86c0b9a062e87a855e77119f605a59729b8533d87f3cb60b806658e5a092de1a0e6144ee3fce4ed"),
			38: sp.bls12_381_g1("0x137ff0f4b5ccd926abfeb02b21c88ae73bb28b1be55f2eb2f47f7970ce063b4121567bf4884e3b8dc6112fdb2d635e5e197cf46d57dabc0764e0f40368ecc68b5b21f5aa7c234064011c5c7bf1d1977dadb4a6434cb9888df81a2335b226570a"),
			39: sp.bls12_381_g1("0x08f25d9802c8e45446d09eb735c295bab29ff23de786e66567c55415dbf3fde0792ad6478c5fe7f9d56de3acf2f3c35a0680c61bdf345c5ba6ba2ee12583768ab899e1cfdb63195f23705d7f555988ad392e768ad6ae8755b2e2271455acf289"),
			40: sp.bls12_381_g1("0x0663a6b65b8ba688e0b17a592efb7bcd80afdff188706fd8fc0a1a1eaf44e5b77031b135be1faae06694a3622f97c3ac1139987d7552b2f476a40c9bf650e765c4ed953fa1b5a918bd1ba0e558d8f8c970d79bc59650a272eb35cd072f228ddd"),
			41: sp.bls12_381_g1("0x0377e0af183eb7744d4e6d41f15d046412772409bbe56b320d8c849923855f6ad6f505c374b34105984a93658a4deba70345b1a183cedb61ef98e73082c019d2f643843983a7d89a775258684c6c53cefdfebb3083eff4b9f7f74efba5c9e462")
		}
        
        vk_query = sp.local('vk_query', vk_query_not_local)

        vk_x_not_local  = sp.mul(vk_query.value[1], params.input[0]) 
        vk_x = sp.local('vk_x', vk_x_not_local)
        
        # sp.range(x, y) goes from x (inclusive) to y (exclusive)
        sp.for i in sp.range(1, sp.len(vk_query.value) - 1):
            vk_x.value = vk_x.value + sp.mul(vk_query.value[ i + 1], params.input[i])

        vk_x.value = vk_x.value + vk_query.value[0]     

        list_pair1 = sp.list([
            sp.pair(vk_g_alpha,vk_h_beta),
            sp.pair(vk_x.value,vk_h_gamma),
            sp.pair(params.proof_c,vk_h),
            sp.pair(- (params.proof_a+vk_g_alpha),params.proof_b+vk_h_beta)
        ])

        list_pair2 = sp.list([
            sp.pair(params.proof_a,vk_h_gamma),
            sp.pair(- vk_g_gamma,params.proof_b)
        ])

        check1 = sp.pairing_check(list_pair1)
        check2 = sp.pairing_check(list_pair2)
        sp.if check1 != True:
            sp.failwith("The proof is not valid, check1 failed")
        sp.if check2 != True:
            sp.failwith("The proof is not valid, check2 failed")

sp.add_compilation_target("RegisterVerifier", RegisterVerifier())
